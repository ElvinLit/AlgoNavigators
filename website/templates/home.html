{% extends "base.html" %}

{% block title %}Home{% endblock %}

{% block content %}
    <h1 align="center" style="margin-block: 10px;">AlgoNavigator</h1>

    <!-- Chatbox -->
    <style>
        .chat-entry {
            margin-top: 4px;
            margin-bottom: 4px;
            margin-left: 4px;
            margin-right: 4px;
            border: 2px solid white; 
            padding: 15px;
            border-radius: 15px; /* Adjust the value to control the roundness of the edges */
            background-color: #394867;
        }
    
        #chatbox {
            height: 50vh;
            width: 100%;
            border: 3px solid white;
            overflow: auto;
            background-color: transparent;
            color: white;
            border-radius: 20px; /* Adjust the value to control the roundness of the edges */
        }
    </style>
    
    <div id="chatbox">
        {% for note in user.notes %}
            <div class="chat-entry">
                {{ note.data }}
                <button type="button" class="close" onClick="deleteNote({{ note.id }})">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
        {% endfor %}
    </div>

    <script>
        // Automatically scroll the chatbox to the bottom when the page is loaded or reloaded
        document.addEventListener('DOMContentLoaded', function() {
            var chatbox = document.getElementById('chatbox');
            chatbox.scrollTop = chatbox.scrollHeight;
        });
    </script>

    <style>
        /* Styling the scrollbar for webkit-based browsers */
        #chatbox::-webkit-scrollbar {
        width: 0px; /* Set the width of the scrollbar */
        }
    </style>

    <!-- Message Box & Button -->
    <style>
        /* Apply the same border-radius to the form elements */
        #userInput textarea,
        .btn-custom-outline {
            border-radius: 15px; /* Adjust the value to control the roundness of the edges */
        }
    </style>
    
    <form method="POST">
        <div id="userInput" style="margin-top: 10px;">
            <textarea name="note" id="userMessage" placeholder="Type a message..." class="form-control" style="background-color: transparent; color: white; border: 3px solid white; border-radius: 15px;"></textarea>
            <center>
                <style>
                    /* Default outline button styles */
                    .btn-custom-outline {
                        margin-top: 10px;
                        background-color: transparent;
                        color: white;
                        border: 2px solid white;
                    }
                    /* Button styles on hover */
                    .btn-custom-outline:hover {
                        box-shadow: 0 0 10px 0.2px #00ffa28e;
                        border-color: #00ffa2; /* Change the border color on hover */
                        color: #00ffa2; /* Change the text color on hover */
                    }
                </style>
                <button type="submit" class="btn btn-custom-outline">Send</button>
                <span style="margin-left: 5px;"></span> <!-- Add a small space here -->
                <button type="button" class="btn btn-custom-outline" onClick="startNewConversation()">Start New Conversation</button>
            </center>
        </div>
    </form>
    
    <script>
        // Function to delete all notes and start new conversation
        function startNewConversation() {
            fetch("/delete-all-notes", {
                method: "POST",
                body: JSON.stringify({}),
            }).then((_res) => {
                window.location.href = "/";
            });
        }
    </script>

    <style>
        /* Custom CSS for the colored popup */
        .colored-modal .modal-content {
            background-color: #212A3E; /* Set the background color to blue */
            color: white; /* Set the text color to white */
            border: 0px solid white;
            border-radius: 15px;
            width: 100%;
            height: 800px;  
            box-shadow: 0 4px 40px black;
        }
        .colored-modal .modal-dialog {
            max-width: 1000px
        }
        .colored-modal .modal-header {
            border-bottom: none; /* Remove the border at the bottom of the modal header */
        }
        .colored-modal .modal-footer {
            border-top: none; /* Remove the border at the top of the modal footer */
        }
    </style>

    <div class="container mt-5 text-center">
        <!-- Button to trigger the popup, change button type to "submit" in order to invoke API -->
        <form action="{{ url_for('chat.flights') }}" method="get">
            <button type="button" class="btn btn-custom-outline" data-toggle="modal" data-target="#myModal">Find Flights</button> 
        </form>

        <!-- Modal (Popup) -->
        <div class="modal fade colored-modal" id="myModal">
        <div class="modal-dialog">
            <div class="modal-content">
    
            <!-- Modal Header -->
            <div class="modal-header">
                <h4 class="modal-title">Flights</h4>
            </div>
    
            <!-- Modal body -->
            <div class="modal-body ">
                <style>
                    /* Custom CSS for the clickable box */
                    .clickable-box {
                        border: 2px solid white;
                        padding: 10px;
                        border-radius: 5px;
                        cursor: pointer;
                    }
                    /* Style for the text inside the clickable box */
                    .box-text {
                        font-size: 16px;
                        color: white;
                        text-decoration: none;
                    }
                    /* Style for other elements inside the clickable box (e.g., buttons) */
                    .box-content {
                        margin-top: 10px;
                    }
                </style>
                <div class="clickable-box" onclick="alert('You clicked the box!')">
                    <!-- Text inside the clickable box -->
                    <p class="box-text">Jit da Jit da Jittison Jitling Jitmuangnon</p>
                </div>
            </div>
    
            <!-- Modal footer -->
            <div class="modal-footer">
                <button type="button" class="btn btn-custom-outline" data-dismiss="modal">Close</button>
            </div>
    
            </div>
        </div>
        </div>
    </div>

{% endblock %}
